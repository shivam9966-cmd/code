#  Save the final granular DataFrame 
OUTPUT_PATH = "Files/SQL_DUMPS"

(
    granular
      .coalesce(1)                      # create just 1 CSV file
      .write
      .mode("overwrite")                # overwrite any existing file
      .option("header", "true")         # include headers
      .csv(OUTPUT_PATH)
)

print(f" Granular KPI file saved successfully â†’ {OUTPUT_PATH}")
