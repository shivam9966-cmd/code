from pyspark.sql import functions as F

# 1. Rename Actual & Forecasted to correct names
df_clean = (
    df_2426
        .withColumnRenamed("Actual", "actual_months")
        .withColumnRenamed("Forecasted", "forecasted_months")
)

# 2. Replace NULLs in both new month columns with 0
df_clean = df_clean.fillna({
    "actual_months": 0,
    "forecasted_months": 0
})

# 3. OPTIONAL: ensure both are integers
df_clean = (
    df_clean
        .withColumn("actual_months", F.col("actual_months").cast("int"))
        .withColumn("forecasted_months", F.col("forecasted_months").cast("int"))
)

df_clean.show(5)
print("Columns:", df_clean.columns)
