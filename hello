from pyspark.sql import functions as F

# Add YEAR column
granular_year = granular.withColumn("YEAR", F.year(F.col("DATE")))

# Apply filter for 2024 + 2025 + 2026 (Planned only)
df_2426 = (
    granular_year
    .filter(
        (F.col("YEAR").isin(2024, 2025)) |
        ((F.col("YEAR") == 2026) & (F.col("scenario") == "Planned"))
    )
)

print("Filtered rows:", df_2426.count())
