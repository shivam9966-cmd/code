# Overwrite same folder, single CSV file
TARGET_PATH = "Files/SQL_DUMPS/FACTS_CONCAT_DEDUP_JOINED_KPI"  # same path as before

(
    granular_strict
      .coalesce(1)                     # make it one single file
      .write
      .mode("overwrite")               # overwrite existing files in folder
      .option("header", "true")        # include column headers
      .csv(TARGET_PATH)                # write as CSV instead of parquet
)

print(f"[OK] Overwritten with one CSV file at â†’ {TARGET_PATH}")
