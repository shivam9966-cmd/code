def fetch_base_kpi_data(self, year: int, month: int | None = None):
    with self.get_cursor() as cursor:

        if month is None:
            cursor.execute("""
                SELECT MAX(month)
                FROM finance.kpi_data
                WHERE year = %s
            """, (year,))
            month = cursor.fetchone()[0]

        cursor.execute("""
            SELECT
                kpi,
                SUM(CASE WHEN forecast_type = 'Latest' THEN amount ELSE 0 END) AS latest,
                SUM(CASE WHEN forecast_type = 'Prior' THEN amount ELSE 0 END) AS prior,
                SUM(CASE WHEN scenario = 'Plan' THEN amount ELSE 0 END) AS plan
            FROM finance.kpi_data
            WHERE year = %s
              AND month = %s
              AND kpi IN ('Revenue', 'OPEX', 'EBITDA')
            GROUP BY kpi
        """, (year, month))

        rows = cursor.fetchall()

    return {
        "year": year,
        "month": month,
        "data": {
            row[0]: {"latest": row[1], "prior": row[2], "plan": row[3]}
            for row in rows
        }
