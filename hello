year_summary = (anomalies_df
                .withColumn("year", F.year("predictive_date"))
                .groupBy("year", "aan_name")
                .agg(F.count("*").alias("num_anomalies"))
                .orderBy("year", "aan_name"))

display(year_summary)
