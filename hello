import pandas as pd
from sqlalchemy import create_engine, text

# ====== EDIT THESE ======
CSV_PATH = r"C:\path\to\your_file.csv"     # change
DB_HOST = "localhost"
DB_PORT = 5432
DB_NAME = "postgres"
DB_USER = "postgres"
DB_PASSWORD = "YOUR_PASSWORD"             # change

SCHEMA = "AIML"                            # your schema
TABLE = "forecasting_data"                 # your new table name (no spaces)
# ========================

engine = create_engine(
    f"postgresql+psycopg2://{DB_USER}:{DB_PASSWORD}@{DB_HOST}:{DB_PORT}/{DB_NAME}"
)

# Read CSV
df = pd.read_csv(CSV_PATH)

# Create schema if not exists
with engine.begin() as conn:
    conn.execute(text(f'CREATE SCHEMA IF NOT EXISTS "{SCHEMA}";'))

# Create/replace table + load data
df.to_sql(
    name=TABLE,
    con=engine,
    schema=SCHEMA,
    if_exists="replace",   # drops & recreates table
    index=False
)

print(f'âœ… Loaded CSV into "{SCHEMA}"."{TABLE}"')
