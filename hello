pip install psycopg2-binary pandas


import pandas as pd
import psycopg2
from psycopg2 import sql

# Load CSV
df = pd.read_csv("one_month_data.csv")

# PostgreSQL connection
conn = psycopg2.connect(
    dbname="your_database",
    user="postgres",
    password="your_password",
    host="localhost",
    port="5432"
)

cur = conn.cursor()

# Create table dynamically (based on dataframe)
columns = ", ".join([f'"{col}" TEXT' for col in df.columns])

create_table_query = f'''
CREATE TABLE IF NOT EXISTS one_month_data (
    {columns}
);
'''

cur.execute(create_table_query)
conn.commit()

# Insert data
for _, row in df.iterrows():
    placeholders = ", ".join(["%s"] * len(row))
    insert_query = f'''
        INSERT INTO one_month_data VALUES ({placeholders})
    '''
    cur.execute(insert_query, tuple(row))

conn.commit()
cur.close()
conn.close()

print("one_month_data uploaded successfully (no SQLAlchemy)")
