from pyspark.sql import functions as F

df = df.withColumn(
    "quarter_num",
    F.regexp_extract(F.col("quarter"), r"Q([1-4])", 1).cast("int")
)
