# --- Monthly count for a given year ---
target_year = 2025

monthly_df = (
    granular
    .withColumn("YEAR", F.year("DATE"))
    .withColumn("MONTH", F.month("DATE"))
    .filter(F.col("YEAR") == target_year)
    .groupBy("YEAR", "MONTH")
    .count()
    .orderBy("MONTH")
)

print(f"Monthly row counts for {target_year}:")
monthly_df.show(truncate=False)
