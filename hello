import psycopg2

CSV_PATH = r"C:\path\to\your_file.csv"   # change this

conn = psycopg2.connect(
    host="localhost",
    port=5432,
    database="postgres",
    user="postgres",
    password="YOUR_PASSWORD"
)

cur = conn.cursor()

with open(CSV_PATH, "r", encoding="utf-8") as f:
    cur.copy_expert(
        """
        COPY "AI-ML"."Forecasting Data"
        FROM STDIN
        WITH (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        """,
        f
    )

conn.commit()
cur.close()
conn.close()

print("CSV uploaded into AI-ML.Forecasting Data âœ…")
