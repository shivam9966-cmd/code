df_csv = df_csv.withColumnRenamed("CC_PR_AC", "cc_pr_ac")


df_csv = df_csv.drop("rank_actual")


from pyspark.sql import functions as F

df_csv = df_csv.withColumn(
    "quarter_num",
    F.when(
        F.col("quarter").rlike("(?i)^q[1-4]$"),
        F.regexp_extract(F.col("quarter"), r"([1-4])", 1).cast("int")
    ).otherwise(None)
)

