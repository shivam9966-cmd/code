from pyspark.sql import functions as F

# assuming your DataFrame is named subset
subset = subset.withColumn("date", F.to_date("date"))  # ensure proper date type

# capture all March 2022 records (use Â±1 day buffer for safety)
subset_march22 = subset.filter(
    (F.month("date") == 3) & (F.year("date") == 2022)
)

subset_march22.show(20, False)      # preview top 20
print("Total rows for March 2022:", subset_march22.count())
