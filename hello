def get_kpi_totals(df, kpi_type, scenario, version):
    return (
        df.filter(
            (F.col("KPI") == kpi_type) &
            (F.col("SCENARIO") == scenario) &
            (F.col("VERSION") == version) &
            (F.col("YEAR") == 2025)
        )
        .groupBy("account_L3_Description")
        .agg(F.sum("Amount").alias("Amount"))
    )
