from datetime import datetime


timestamp = datetime.now().strftime("%Y-%m-%d_%H-%M-%S")

base_folder = "Files/SQL_DUMPS/FINAL_EXPORTS"
run_folder = f"{base_folder}/Run_{timestamp}"


granular.write.mode("errorifexists").option("header", True).csv(f"{run_folder}/granular_full")

# Save small subset
subset.write.mode("errorifexists").option("header", True).csv(f"{run_folder}/granular_subset")

print(f"âœ… Both datasets saved successfully under:\nðŸ“‚ {run_folder}")
print(" - granular_full â†’ full consolidated dataset")
print(" - granular_subset â†’ filtered subset (~5K rows)")
